<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑 | 2taezeat, blog</title>
<meta name=keywords content="JPA,Backend"><meta name=description content="자바 ORM 표준 JPA 프로그래밍, ch06. 다양한 연관관계 매핑, 간단 정리"><meta name=author content="2taezeat"><link rel=canonical href=https://2taezeat.github.io/posts/jpa/%EC%9E%90%EB%B0%94-orm-%ED%91%9C%EC%A4%80-jpa-ch06.-%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/><meta name=google-site-verification content="YaEERzgrvu-ZwPg7gswZdTzRMufkHw3uIH7i8hVal1c"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.cc8105bf49785484525cafc7883272c26982bf06e1663dcfa3b55c3bb3f773b6.css integrity="sha256-zIEFv0l4VIRSXK/HiDJywmmCvwbhZj3Po7VcO7P3c7Y=" rel="preload stylesheet" as=style><link rel=icon href=https://2taezeat.github.io/icon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://2taezeat.github.io/icon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://2taezeat.github.io/icon/favicon-32x32.png><link rel=apple-touch-icon href=https://2taezeat.github.io/icon/apple-touch-icon.png><link rel=mask-icon href=https://2taezeat.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://2taezeat.github.io/posts/jpa/%EC%9E%90%EB%B0%94-orm-%ED%91%9C%EC%A4%80-jpa-ch06.-%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="[자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑"><meta property="og:description" content="자바 ORM 표준 JPA 프로그래밍, ch06. 다양한 연관관계 매핑, 간단 정리"><meta property="og:type" content="article"><meta property="og:url" content="https://2taezeat.github.io/posts/jpa/%EC%9E%90%EB%B0%94-orm-%ED%91%9C%EC%A4%80-jpa-ch06.-%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"><meta property="og:image" content="https://2taezeat.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-06T11:30:03+00:00"><meta property="article:modified_time" content="2024-08-06T11:30:03+00:00"><meta property="og:site_name" content="2taezeat, blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://2taezeat.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="[자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑"><meta name=twitter:description content="자바 ORM 표준 JPA 프로그래밍, ch06. 다양한 연관관계 매핑, 간단 정리"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://2taezeat.github.io/posts/"},{"@type":"ListItem","position":2,"name":"[자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑","item":"https://2taezeat.github.io/posts/jpa/%EC%9E%90%EB%B0%94-orm-%ED%91%9C%EC%A4%80-jpa-ch06.-%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑","name":"[자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑","description":"자바 ORM 표준 JPA 프로그래밍, ch06. 다양한 연관관계 매핑, 간단 정리","keywords":["JPA","Backend"],"articleBody":"6.1 다대일 (N:1) 6.1.1 다대일, 단방향, [N:1] @Joincolumn (name = \"TEAM_ID\")를 사용해서 Member.team 필드를 TEAM_ID 외래 키와 매핑했다.\n따라서 Member.team 필드로 회원 테이블의 TEAM_ID 외래키를 관리한다.\n6.1.2 다대일, 양방향, [N:1, 1:N] 양뱡향은 외래 키가 있는 쪽이 연관관계의 주인이다. 일대다와 다대일 연관관계는 항상 다(N)에 외래 키가 있다. 여기서는 다쪽인 MEMBER 테이블이 외래 키를 가지고 있으므로 Member.team이 연관관계의 주인이다. JPA는 외래 키를 관리할 때 연관관계의 주인만 사용한다. 주인이 아닌 Team.members는 조회를 위한 JPQL이나 객체 그래프를 탐색할 때 사용한다. 양뱡향 연관관계는 항상 서로를 참조해야 한다. 항상 서로 참조하게 하려면 편의 메소드가 있으면 좋다, Ex) 회원의 setTeam(), 팀의 addMember() 양쪽에 다 작성하면 무한루프에 빠지므로 주의해야 한다. 6.2 일대다 (1:N) 6.2.1 일대다, 단방향, [1:N] 일대다 단방향 관계는 약간 특이한데, 엔티티의 Team.members로 회원 테이블의 TEAM_ID 외래 키를 관리한다.\n보통 자신이 매핑한 테이블의 외래 키를 관리하는데, 이 매핑은 반대쪽 테이블에 있는 외래 키를 관리한다.\n그럴 수밖에 없는 것이 일대다 관계에서 외래 키는 항상 다쪽 테이블에 있다. 하지만 다 쪽인 Member 엔티티에는 외래 키를 매핑할 수 있는 참조 필드가 없다. 대신에 반대쪽인 Team 엔티티에만 참조 필드인 members가 있다. 따라서 반대편 테이블의 외래 키를 관리하는 특이한 모습이 나타난다. 일대다 단방향 관계를 매핑할 때는 @JoinColumn을 명시해야 한다.\n그렇지 않으면 JPA는 조인 테이블(JoinTable) 전략을 기본으로 사용해서 매핑한다. [ 일대다 단방향 매핑의 단점 ]\n일대다 단방향 매핑의 단점은 매핑한 객체가 관리하는 외래 키가 다른 테이블에 있다는 점이다.\n본인 테이블에 외래 키가 있으면 엔티티의 저장과 연관관계 처리를 INSERT SQL 한 번으로 끝낼 수 있다\n하지만, 다른 테이블에 외래 키가 있으면 연관관계 처리를 위한 UPDATE SQL을 추가로 실행해야 한다.\n일대다 단방향 매핑보다는 다대일 양방향 매핑을 사용하자\n일대다 단방향 매핑을 사용하면 엔티티를 매핑한 테이블이 아닌 다른 테이블의 외래 키를 관리해야 한다. 성능 문제도 있지만 관리도 부담 문제를 해결하는 좋은 방법은 일대다 단방향 매핑 대신에 다대일 양방향 매핑을 사용하는 것이다. 6.2.2 일대다, 양방향, [1:N, N:1] 일대다 양방향 매핑은 존재하지 않는다. 대신 다대일 양방향 매핑을 사용해야 한다\n일대다 양방향과 다대일 양방향은 사실 똑같은 말이다. 여기서는 왼쪽을 연관관계의 주인으로 가정해서 분류했다. 예를 들어 다대일이면 다(N)가 연관관계의 주인이다. 더 정확히 말하자면 양방향 매핑에서 @OneToMany는 연관관계의 주인이 될 수 없다.\n왜냐하면 관계형 데이터베이스의 특성상 일대다, 다대일 관계는 항상 다쪽에 외래 키가 있다. 따라서 @OneToMany, @ManyToOne 둘 중에 연관관계의 주인은 항상 다 쪽인 @ManyToOne을 사용한 곳이다.\n이런 이유로 @ManyToOne에는 mappedBy 속성이 없다. 그렇다고 일대다 양방향 매핑이 완전히 불가능한 것은 아니다.\n일대다 단방향 매핑 반대편에 같은 외래 키를 사용하는 다대일 단방향 매핑을 읽기 전용으로 하나 추가하면 된다.\n하지만 일대다 단방향 매핑이 가지는 단점을 그대로 가지기 때문에, 될 수 있으면 다대일 양방향 매핑을 사용하자\n6.3 일대일 (1:1) 일대일 관계는 그 반대도 일대일 관계다. 테이블 관계에서 일대다, 다대일은 항상 다(N)쪽이 외래 키를 가진다. 반면에 일대일 관계는 주 테이블이나 대상 테이블 둘 중 어느 곳이나 외래 키를 가질 수 있다. 따라서 일대일 관계는 주 테이블이나 대상 테이블 중에 누가 외래 키를 가질지 선택해야 한다. 6.3.1 주 테이블에 외래 키 일대일 관계를 구성할 때 객체지향 개발자들은 주 테이블에 외래 키가 있는 것을 선호한다.\nJPA도 주 테이블에 외래 키가 있으면 좀 더 편리하게 매핑할 수 있다.\n단방향 일대일 관계이므로 객체 매핑에 @OneToOne을 사용했고 데이터베이스에는 LOCKER_ID 외래 키에 유니크 제약 조건(UNI) 을 추가했다. 이 관계는 다대일 단방향(@ManyToOne)과 거의 비슷하다. 양방향 양방향이므로 연관관계의 주인을 정해야 한다. MEMBER 테이블이 외래 키를 가지고 있으므로 Member 엔티티에 있는 Member.locker가 연관관계의 주인이다. 따라서 반대 매핑인 사물함의 Locker.member는 mappedBy를 선언해서 연관관계의 주인이 아니라고 설정 6.3.2 대상 테이블에 외래 키 단방향 양방향 일대일 매핑에서 대상 테이블에 외래 키를 두고 싶으면 이렇게 양방향으로 매핑한다. 주 엔티티인 Member 엔티티 대신에 대상 엔티티인 Locker를 연관관계의 주인으로 만들어서, LOCKER 테이블의 외래 키를 관리 6.4 다대다 (N:M) 관계형 데이터베이스는 정규화된 테이블 2개로 다대다 관계를 표현할 수 없다.\n그래서 보통 다대다 관계를 일대다, 다대일 관계로 풀어내는 연결 테이블을 사용한다.\n예를 들어 회원들은 상품을 주문한다. 반대로 상품들은 회원들에 의해 주문된다.\n둘은 다대다 관계다. 따라서 회원 테이블과 상품 테이블만으로는 이 관계를 표현할 수 없다.\n그런데 객체는 테이블과 다르게 객체 2개로 다대다 관계를 만들 수 있다.\n회원 객체는 컬렉션을 사용해서 상품들을 참조하면 되고 반대로 상품들도 컬렉션을 사용해서 회원들을 참조하면 된다.\n@ManyToMany를 사용하면 다대다 관계를 편리하게 매핑할 수 있다.\n6.4.1 다대다: 단방향 회원 엔티티와 상품 엔티티를 @ManyToMany로 매핑했다.\n중요한 점은 @ManyToMany와 @JoinTable을 사용해서 연결 테이블을 바로 매핑한 것이다.\n따라서 회원과 상품을 연결하는 회원_상품(Member_Product) 엔티티 없이 매핑을 완료할수 있다.\n@ManyToMany로 매핑한 덕분에 다대다 관계를 사용할 때는 이 연결 테이블을 신경 쓰지 않아도 된다.\n[ 연결 테이블을 매핑하는 @JoinTable의 속성 ]\n@JoinTable.name: 연결 테이블을 지정한다. 여기서는 MEMBER_PRODUCT 테이블을 선택 @JoinTable.joinColumns: 현재 방향인 회원과 매핑할 조인 컬럼 정보를 지정한다. MEMBER_ID로 지정 @JoinTable.inversejoinColumns: 반대 방향인 상품과 매핑할 조인 컬럼 정보를 지정한다. PRODUCT_ID로 지정 6.4.2 다대다: 양방향 6.4.3 다대다: 매핑의 한계와 극복, 연결 엔티티 사용 @ManyToMany를 사용하면 연결 테이블을 자동으로 처리해주므로 도메인 모델이 단순해지고 여러 가지로 편리하다.\n하지만 이 매핑을 실무에서 사용하기에는 한계가 있다. 회원이 상품을 주문하면 연결 테이블에 단순히 주문한 회원 아이디와 상품 아이디만 담고 끝나지 않는다.\n보통은 연결 테이블에 주문 수량 컬럼이나 주문한 날짜 같은 컬럼이 더 필요하다.\n결국, 연결 테이블을 매핑하는 연결 엔티티를 만들고 이곳에 추가한 컬럼들을 매핑해야 한다.\n그리고 엔티티 간의 관계도 테이블 관계처럼 다대다에서 일대다, 다대일 관계로 풀어야 한다.\n여기서는 회원상품(MemberProduct) 엔티티를 추가했다.\n회원상품(MemberProduct) 엔티티를 보면, 기본 키를 매핑하는 @Id 와 외래 키를 매핑하는 @JoinColumn을 동시에 사용해서 기본 키 + 외래 키를 한번에 매핑했다.\n그리고 @Idclass를 사용해서 복합 기본 키를 매핑했다.\n복합 기본 키 회원상품 엔티티는 기본 키가 MEMBER_ID와 PRODUCT_ID로 이루어진 복합 기본 키(=복합 키)\nJPA에서 복합 키를 사용하려면 별도의 식별자 클래스를 만들어야 한다.\n그리고 엔티티에 @IdClass를 사용해서 식별자 클래스를 지정하면 된다.\nMemberProductId 클래스를 복합 키를 위한 식별자 클래스로 사용한다.\n[ 복합 키를 위한 식별자 클래스 특징 ]\n복합 키는 별도의 식별자 클래스로 만들어야 한다. Serializable을 구현해야 한다. equals와 hashCode 메소드를 구현해야 한다. 기본 생성자가 있어야 한다. 식별자 클래스는 public이어야 한다. @ldClass를 사용하는 방법 외에 @EmbeddedId를 사용하는 방법도 있다. 회원상품(MemberProduct) 은 회원과 상품의 기본 키를 받아서 자신의 기본 키로 사용한다.\n이렇게 부모 테이블의 기본 키를 받아서 자신의 기본 키 + 외래 키로 사용하는 것을 식별 관계 (Identifying Relationship) 라 한다.\n지금까지는 기본 키가 단순해서 기본 키를 위한 객체를 사용하는 일이 없었지만 복합 키가 되면 이야기가 달라진다.\n복합 키는 항상 식별자 클래스를 만들어야한다. em.find()를 보면 생성한 식별자 클래스로 엔티티를 조회한다.\n복합 키를 사용하는 방법은 복잡하다. 복합 키를 사용하면 ORM 매핑에서 처리할 일이 상당히 많아진다.\n6.4.4 다대다: 새로운 기본 키 사용 추천하는 기본 키 생성 전략은 데이터베이스에서 자동으로 생성해주는 대리 키를 Long 값으로 사용하는 것이다.\n장점은 간편하고 거의 영구히 쓸 수 있으며, 비즈니스에 의존하지 않는다.\n또한 ORM 매핑 시에 복합 키를 만들지 않아도 되므로 간단히 매핑을 완성할 수 있다.\n식별자 클래스를 사용하지 않아서 코드가 한결 단순해짐\n이처럼 새로운 기본 키를 사용해서 다대다 관계를 풀어내는 것도 좋은 방법\n6.4.5 다대다 연관관계 정리 식별 관계: 받아온 식별자를 기본 키 + 외래 키로 사용한다. 비식별 관계: 받아온 식별자는 외래 키로만 사용하고 새로운 식별자를 추가한다. 식별자 클래스를 만들지 않아도 편리하게 ORM 매핑 가능 이런 이유로 식별 관계보다는 비식별 관계를 추천 6.5 활용 (Kotlin) 요구 사항 분석 및 설계 Code 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 // build.gradle.kts에 아래 설정이 있다고 가정 // Kotlin으로 JPA을 쉽게 사용하기 위한 설정 plugins { kotlin(\"plugin.jpa\") version \"1.9.24\" } allOpen { annotation(\"jakarta.persistence.Entity\") annotation(\"jakarta.persistence.Embeddable\") annotation(\"jakarta.persistence.MappedSuperclass\") } noArg { annotation(\"jakarta.persistence.Entity\") } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 package ~~ import jakarta.persistence.* import java.util.Date @Entity class Member( name: String, street: String, zipcode: String ) { @Id @GeneratedValue @Column(name = \"MEMBER_ID\") var id: Long? = null protected set var name = name protected set var street = street protected set var zipcode = zipcode protected set @OneToMany(mappedBy = \"member\") val orders: MutableList\u003cOrder\u003e = mutableListOf() } enum class OrderStatus { ORDER, CANCEL } enum class DeliveryStatus { READY, COMP } @Entity @Table(name = \"DELIVERY\") class Delivery( zipcode: String, status: DeliveryStatus ) { @Id @GeneratedValue @Column(name = \"DELIVERY_ID\") var id: Long? = null protected set var zipcode = zipcode protected set @Enumerated(EnumType.STRING) var status: DeliveryStatus = status protected set @OneToOne(mappedBy = \"delivery\") var order: Order? = null protected set fun associateWithOrder(order: Order) { this.order = order } } @Entity @Table(name = \"ORDERS\") class Order( member: Member, orderDate: Date, status: OrderStatus ) { @Id @GeneratedValue @Column(name = \"ORDER_ID\") var id: Long? = null protected set @Column(name = \"MEMBER_ID\") var memberId: Long? = null protected set @Temporal(TemporalType.TIMESTAMP) var orderDate: Date = orderDate protected set @Enumerated(EnumType.STRING) var status: OrderStatus = status protected set @ManyToOne @JoinColumn(name = \"MEMBER_ID\") var member: Member? = member protected set @OneToMany(mappedBy = \"order\") val orderItems: MutableList\u003cOrderItem\u003e = mutableListOf() @OneToOne @JoinColumn(name = \"DELIVERY_ID\") var delivery: Delivery? = null protected set fun settingMember(member: Member) { this.member?.let { it.orders.remove(this) } this.member = member member.orders.add(this) } fun addOrderItem(orderItem: OrderItem) { orderItem.order?.let { it.orderItems.remove(orderItem) } orderItems.add(orderItem) orderItem.associateWithOrder(this) } fun settingDelivery(delivery: Delivery) { this.delivery = delivery delivery.associateWithOrder(this) } } @Entity class OrderItem( orderPrice: Int, count: Int ) { @Id @GeneratedValue @Column(name = \"ORDER_ITEM_ID\") var id: Long? = null protected set @Column(name = \"ITEM_ID\") var itemID: Long? = null protected set var orderPrice: Int = orderPrice protected set var count: Int = count protected set @ManyToOne @JoinColumn(name = \"ORDER_ID\") var order: Order? = null protected set fun associateWithOrder(order: Order) { this.order = order } } @Entity class Item( name: String, price: Int, stockQuantity: Int ) { @Id @GeneratedValue @Column(name = \"ITEM_ID\") var id: Long? = null var name: String = name protected set var price: Int = price protected set var stockQuantity: Int = stockQuantity protected set } Reference 자바 ORM 표준 JPA 프로그래밍 (김영한) https://product.kyobobook.co.kr/detail/S000001766367 ","wordCount":"1669","inLanguage":"en","image":"https://2taezeat.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-08-06T11:30:03Z","dateModified":"2024-08-06T11:30:03Z","author":{"@type":"Person","name":"2taezeat"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://2taezeat.github.io/posts/jpa/%EC%9E%90%EB%B0%94-orm-%ED%91%9C%EC%A4%80-jpa-ch06.-%EB%8B%A4%EC%96%91%ED%95%9C-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91/"},"publisher":{"@type":"Organization","name":"2taezeat, blog","logo":{"@type":"ImageObject","url":"https://2taezeat.github.io/icon/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://2taezeat.github.io/ accesskey=h title="2taezeat blog (Alt + H)"><img src=https://2taezeat.github.io/icon/apple-touch-icon.png alt aria-label=logo height=30>2taezeat blog</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://2taezeat.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://2taezeat.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://2taezeat.github.io/searchs/ title=Search><span>Search</span></a></li><li><a href=https://github.com/2taezeat title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://2taezeat.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://2taezeat.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑</h1><div class=post-description>자바 ORM 표준 JPA 프로그래밍, ch06. 다양한 연관관계 매핑, 간단 정리</div><div class=post-meta><span title='2024-08-06 11:30:03 +0000 +0000'>2024-08-06</span>&nbsp;·&nbsp;8 min&nbsp;·&nbsp;1669 words&nbsp;·&nbsp;2taezeat</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#61-다대일-n1>6.1 다대일 (N:1)</a><ul><li><a href=#611-다대일-단방향-n1>6.1.1 다대일, 단방향, [N:1]</a></li><li><a href=#612-다대일-양방향-n1-1n>6.1.2 다대일, 양방향, [N:1, 1:N]</a></li></ul></li><li><a href=#62-일대다-1n>6.2 일대다 (1:N)</a><ul><li><a href=#621-일대다-단방향-1n>6.2.1 일대다, 단방향, [1:N]</a></li><li><a href=#622-일대다-양방향-1n-n1>6.2.2 일대다, 양방향, [1:N, N:1]</a></li></ul></li><li><a href=#63-일대일-11>6.3 일대일 (1:1)</a><ul><li><a href=#631-주-테이블에-외래-키>6.3.1 주 테이블에 외래 키</a><ul><li><a href=#단방향>단방향</a></li><li><a href=#양방향>양방향</a></li></ul></li><li><a href=#632-대상-테이블에-외래-키>6.3.2 대상 테이블에 외래 키</a><ul><li><a href=#단방향-1>단방향</a></li><li><a href=#양방향-1>양방향</a></li></ul></li></ul></li><li><a href=#64-다대다-nm>6.4 다대다 (N:M)</a><ul><li><a href=#641-다대다-단방향>6.4.1 다대다: 단방향</a></li><li><a href=#642-다대다-양방향>6.4.2 다대다: 양방향</a></li><li><a href=#643-다대다-매핑의-한계와-극복-연결-엔티티-사용>6.4.3 다대다: 매핑의 한계와 극복, 연결 엔티티 사용</a><ul><li><a href=#복합-기본-키>복합 기본 키</a></li></ul></li><li><a href=#644-다대다-새로운-기본-키-사용>6.4.4 다대다: 새로운 기본 키 사용</a></li><li><a href=#645-다대다-연관관계-정리>6.4.5 다대다 연관관계 정리</a></li></ul></li><li><a href=#65-활용-kotlin>6.5 활용 (Kotlin)</a><ul><li><a href=#요구-사항-분석-및-설계>요구 사항 분석 및 설계</a></li><li><a href=#code>Code</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></details></div><div class=post-content><h1 id=61-다대일-n1>6.1 다대일 (N:1)<a hidden class=anchor aria-hidden=true href=#61-다대일-n1>#</a></h1><h2 id=611-다대일-단방향-n1>6.1.1 다대일, 단방향, [N:1]<a hidden class=anchor aria-hidden=true href=#611-다대일-단방향-n1>#</a></h2><p><img loading=lazy src=/images/JPA/SCR-20240905-lxhv.png alt=SCR-20240905-lxhv width=680 height=auto></p><ul><li><p><code>@Joincolumn (name = "TEAM_ID")</code>를 사용해서 <code>Member.team</code> 필드를 TEAM_ID <strong>외래 키</strong>와 매핑했다.</p></li><li><p>따라서 <code>Member.team</code> 필드로 회원 테이블의 <strong>TEAM_ID 외래키</strong>를 관리한다.</p></li></ul><h2 id=612-다대일-양방향-n1-1n>6.1.2 다대일, 양방향, [N:1, 1:N]<a hidden class=anchor aria-hidden=true href=#612-다대일-양방향-n1-1n>#</a></h2><p><img loading=lazy src=/images/JPA/SCR-20240905-lxum.png alt=SCR-20240905-lxum width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-lzaa.png alt=SCR-20240905-lzaa width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-lzaj.png alt=SCR-20240905-lzaj width=680 height=auto></p><ul><li>양뱡향은 외래 키가 있는 쪽이 연관관계의 주인이다.<ul><li>일대다와 다대일 연관관계는 항상 다(N)에 외래 키가 있다.</li><li>여기서는 다쪽인 MEMBER 테이블이 외래 키를 가지고 있으므로 <code>Member.team</code>이 연관관계의 주인이다.</li><li>JPA는 외래 키를 관리할 때 연관관계의 주인만 사용한다.</li><li>주인이 아닌 <code>Team.members</code>는 조회를 위한 JPQL이나 객체 그래프를 탐색할 때 사용한다.</li></ul></li><li>양뱡향 연관관계는 항상 서로를 참조해야 한다.<ul><li>항상 서로 참조하게 하려면 편의 메소드가 있으면 좋다, Ex) 회원의 <code>setTeam()</code>, 팀의 <code>addMember()</code></li><li>양쪽에 다 작성하면 무한루프에 빠지므로 주의해야 한다.</li></ul></li></ul><h1 id=62-일대다-1n>6.2 일대다 (1:N)<a hidden class=anchor aria-hidden=true href=#62-일대다-1n>#</a></h1><h2 id=621-일대다-단방향-1n>6.2.1 일대다, 단방향, [1:N]<a hidden class=anchor aria-hidden=true href=#621-일대다-단방향-1n>#</a></h2><p><img loading=lazy src=/images/JPA/SCR-20240905-lzgd.png alt=SCR-20240905-lzgd width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-madd.png alt=SCR-20240905-madd width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-madr.png alt=SCR-20240905-madr width=680 height=auto></p><ul><li><p>일대다 단방향 관계는 약간 특이한데, 엔티티의 <code>Team.members</code>로 회원 테이블의 <strong>TEAM_ID 외래 키</strong>를 관리한다.</p></li><li><p>보통 자신이 매핑한 테이블의 외래 키를 관리하는데, <strong>이 매핑은 반대쪽 테이블에 있는 외래 키를 관리</strong>한다.</p><ul><li>그럴 수밖에 없는 것이 일대다 관계에서 외래 키는 항상 다쪽 테이블에 있다.</li><li>하지만 다 쪽인 Member 엔티티에는 외래 키를 매핑할 수 있는 참조 필드가 없다.</li><li>대신에 반대쪽인 Team 엔티티에만 참조 필드인 <code>members</code>가 있다.</li><li>따라서 반대편 테이블의 외래 키를 관리하는 특이한 모습이 나타난다.</li></ul></li><li><p>일대다 단방향 관계를 매핑할 때는 <code>@JoinColumn</code>을 명시해야 한다.</p><ul><li>그렇지 않으면 JPA는 <strong>조인 테이블(JoinTable)</strong> 전략을 기본으로 사용해서 매핑한다.</li></ul></li></ul><p><strong>[ 일대다 단방향 매핑의 단점 ]</strong></p><p><img loading=lazy src=/images/JPA/SCR-20240905-mbit.png alt=SCR-20240905-mbit width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-mbjc.png alt=SCR-20240905-mbjc width=680 height=auto></p><ul><li><p>일대다 단방향 매핑의 단점은 매핑한 객체가 관리하는 외래 키가 다른 테이블에 있다는 점이다.</p></li><li><p>본인 테이블에 외래 키가 있으면 엔티티의 저장과 연관관계 처리를 <code>INSERT SQL</code> 한 번으로 끝낼 수 있다</p></li><li><p>하지만, 다른 테이블에 외래 키가 있으면 연관관계 처리를 위한 <code>UPDATE SQL</code>을 추가로 실행해야 한다.</p></li><li><p>일대다 단방향 매핑보다는 다대일 양방향 매핑을 사용하자</p><ul><li>일대다 단방향 매핑을 사용하면 엔티티를 매핑한 테이블이 아닌 다른 테이블의 외래 키를 관리해야 한다.</li><li>성능 문제도 있지만 관리도 부담</li><li>문제를 해결하는 좋은 방법은 <strong>일대다 단방향 매핑</strong> 대신에 <strong>다대일 양방향 매핑</strong>을 사용하는 것이다.</li></ul></li></ul><h2 id=622-일대다-양방향-1n-n1>6.2.2 일대다, 양방향, [1:N, N:1]<a hidden class=anchor aria-hidden=true href=#622-일대다-양방향-1n-n1>#</a></h2><ul><li><p><strong>일대다 양방향</strong> 매핑은 존재하지 않는다. 대신 <strong>다대일 양방향</strong> 매핑을 사용해야 한다</p><ul><li><strong>일대다 양방향</strong>과 <strong>다대일 양방향</strong>은 사실 똑같은 말이다.</li><li>여기서는 왼쪽을 연관관계의 주인으로 가정해서 분류했다. 예를 들어 다대일이면 다(N)가 연관관계의 주인이다.</li></ul></li><li><p>더 정확히 말하자면 양방향 매핑에서 <code>@OneToMany</code>는 연관관계의 주인이 될 수 없다.</p><ul><li>왜냐하면 관계형 데이터베이스의 특성상 일대다, 다대일 관계는 항상 <strong>다쪽에 외래 키</strong>가 있다.</li></ul></li><li><p>따라서 <code>@OneToMany, @ManyToOne</code> 둘 중에 연관관계의 주인은 항상 다 쪽인 <code>@ManyToOne</code>을 사용한 곳이다.</p><ul><li>이런 이유로 <code>@ManyToOne</code>에는 <code>mappedBy</code> 속성이 없다.</li></ul></li><li><p>그렇다고 일대다 양방향 매핑이 완전히 불가능한 것은 아니다.</p><ul><li><p>일대다 단방향 매핑 반대편에 <strong>같은 외래 키</strong>를 사용하는 <strong>다대일 단방향 매핑</strong>을 <strong>읽기 전용</strong>으로 하나 추가하면 된다.</p></li><li><p>하지만 일대다 단방향 매핑이 가지는 단점을 그대로 가지기 때문에, 될 수 있으면 <strong>다대일 양방향 매핑</strong>을 사용하자</p></li></ul></li></ul><p><img loading=lazy src=/images/JPA/SCR-20240905-mgse.png alt=SCR-20240905-mgse width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-mgxk.png alt=SCR-20240905-mgxk width=680 height=auto></p><h1 id=63-일대일-11>6.3 일대일 (1:1)<a hidden class=anchor aria-hidden=true href=#63-일대일-11>#</a></h1><ul><li>일대일 관계는 그 반대도 일대일 관계다.</li><li>테이블 관계에서 일대다, 다대일은 항상 다(N)쪽이 외래 키를 가진다.<ul><li>반면에 일대일 관계는 주 테이블이나 대상 테이블 둘 중 어느 곳이나 외래 키를 가질 수 있다.</li><li>따라서 일대일 관계는 주 테이블이나 대상 테이블 중에 누가 외래 키를 가질지 선택해야 한다.</li></ul></li></ul><h2 id=631-주-테이블에-외래-키>6.3.1 주 테이블에 외래 키<a hidden class=anchor aria-hidden=true href=#631-주-테이블에-외래-키>#</a></h2><p>일대일 관계를 구성할 때 객체지향 개발자들은 주 테이블에 외래 키가 있는 것을 선호한다.</p><p>JPA도 주 테이블에 외래 키가 있으면 좀 더 편리하게 매핑할 수 있다.</p><h3 id=단방향>단방향<a hidden class=anchor aria-hidden=true href=#단방향>#</a></h3><p><img loading=lazy src=/images/JPA/SCR-20240905-oclf.png alt=SCR-20240905-oclf width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-ocyv.png alt=SCR-20240905-ocyv width=680 height=auto></p><ul><li>일대일 관계이므로 객체 매핑에 <code>@OneToOne</code>을 사용했고 데이터베이스에는 <code>LOCKER_ID</code> 외래 키에 <strong>유니크 제약 조건(UNI)</strong> 을 추가했다.<ul><li>이 관계는 다대일 단방향(<code>@ManyToOne</code>)과 거의 비슷하다.</li></ul></li></ul><h3 id=양방향>양방향<a hidden class=anchor aria-hidden=true href=#양방향>#</a></h3><p><img loading=lazy src=/images/JPA/SCR-20240905-ocmr.png alt=SCR-20240905-ocmr width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-odfe.png alt=SCR-20240905-odfe width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-odgk.png alt=SCR-20240905-odgk width=680 height=auto></p><ul><li>양방향이므로 연관관계의 주인을 정해야 한다.</li><li>MEMBER 테이블이 외래 키를 가지고 있으므로 Member 엔티티에 있는 <code>Member.locker</code>가 연관관계의 주인이다.</li><li>따라서 반대 매핑인 사물함의 <code>Locker.member</code>는 <code>mappedBy</code>를 선언해서 연관관계의 주인이 아니라고 설정</li></ul><h2 id=632-대상-테이블에-외래-키>6.3.2 대상 테이블에 외래 키<a hidden class=anchor aria-hidden=true href=#632-대상-테이블에-외래-키>#</a></h2><h3 id=단방향-1>단방향<a hidden class=anchor aria-hidden=true href=#단방향-1>#</a></h3><p><img loading=lazy src=/images/JPA/SCR-20240905-oehd.png alt=SCR-20240905-oehd width=680 height=auto></p><h3 id=양방향-1>양방향<a hidden class=anchor aria-hidden=true href=#양방향-1>#</a></h3><p><img loading=lazy src=/images/JPA/SCR-20240905-oejm.png alt=SCR-20240905-oejm width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-oerx.png alt=SCR-20240905-oerx width=680 height=auto></p><ul><li>일대일 매핑에서 대상 테이블에 외래 키를 두고 싶으면 이렇게 양방향으로 매핑한다.</li><li>주 엔티티인 Member 엔티티 대신에 대상 엔티티인 Locker를 연관관계의 주인으로 만들어서, LOCKER 테이블의 외래 키를 관리</li></ul><h1 id=64-다대다-nm>6.4 다대다 (N:M)<a hidden class=anchor aria-hidden=true href=#64-다대다-nm>#</a></h1><p><img loading=lazy src=/images/JPA/SCR-20240905-ofeb.png alt=SCR-20240905-ofeb width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-ofeq.png alt=SCR-20240905-ofeq width=680 height=auto></p><p>관계형 데이터베이스는 정규화된 테이블 2개로 <strong>다대다 관계</strong>를 표현할 수 없다.</p><p>그래서 보통 다대다 관계를 일대다, 다대일 관계로 풀어내는 <strong>연결 테이블</strong>을 사용한다.</p><p>예를 들어 회원들은 상품을 주문한다. 반대로 상품들은 회원들에 의해 주문된다.</p><p>둘은 다대다 관계다. 따라서 회원 테이블과 상품 테이블만으로는 이 관계를 표현할 수 없다.</p><p><img loading=lazy src=/images/JPA/SCR-20240905-ofgn.png alt=SCR-20240905-ofgn width=680 height=auto></p><p>그런데 <strong>객체</strong>는 <strong>테이블</strong>과 다르게 객체 2개로 다대다 관계를 만들 수 있다.</p><p>회원 객체는 컬렉션을 사용해서 상품들을 참조하면 되고 반대로 상품들도 컬렉션을 사용해서 회원들을 참조하면 된다.</p><p><code>@ManyToMany</code>를 사용하면 <strong>다대다 관계</strong>를 편리하게 매핑할 수 있다.</p><h2 id=641-다대다-단방향>6.4.1 다대다: 단방향<a hidden class=anchor aria-hidden=true href=#641-다대다-단방향>#</a></h2><p><img loading=lazy src=/images/JPA/SCR-20240905-oghn.png alt=SCR-20240905-oghn width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-oghy.png alt=SCR-20240905-oghy width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-ogmi.png alt=SCR-20240905-ogmi width=680 height=auto></p><p>회원 엔티티와 상품 엔티티를 <code>@ManyToMany</code>로 매핑했다.</p><p>중요한 점은 <code>@ManyToMany</code>와 <code>@JoinTable</code>을 사용해서 <strong>연결 테이블</strong>을 바로 매핑한 것이다.</p><p>따라서 회원과 상품을 연결하는 <strong>회원_상품(Member_Product)</strong> 엔티티 없이 매핑을 완료할수 있다.</p><p><code>@ManyToMany</code>로 매핑한 덕분에 <strong>다대다 관계</strong>를 사용할 때는 이 <strong>연결 테이블을 신경 쓰지 않아도 된다</strong>.</p><p><strong>[ 연결 테이블을 매핑하는 <code>@JoinTable</code>의 속성 ]</strong></p><ul><li><code>@JoinTable.name</code>: 연결 테이블을 지정한다. 여기서는 MEMBER_PRODUCT 테이블을 선택</li><li><code>@JoinTable.joinColumns</code>: 현재 방향인 회원과 매핑할 조인 컬럼 정보를 지정한다. MEMBER_ID로 지정</li><li><code>@JoinTable.inversejoinColumns</code>: 반대 방향인 상품과 매핑할 조인 컬럼 정보를 지정한다. PRODUCT_ID로 지정</li></ul><h2 id=642-다대다-양방향>6.4.2 다대다: 양방향<a hidden class=anchor aria-hidden=true href=#642-다대다-양방향>#</a></h2><p><img loading=lazy src=/images/JPA/SCR-20240905-ohwa.png alt=SCR-20240905-ohwa width=680 height=auto></p><h2 id=643-다대다-매핑의-한계와-극복-연결-엔티티-사용>6.4.3 다대다: 매핑의 한계와 극복, 연결 엔티티 사용<a hidden class=anchor aria-hidden=true href=#643-다대다-매핑의-한계와-극복-연결-엔티티-사용>#</a></h2><p><img loading=lazy src=/images/JPA/SCR-20240905-oibq.png alt=SCR-20240905-oibq width=680 height=auto></p><p><code>@ManyToMany</code>를 사용하면 연결 테이블을 자동으로 처리해주므로 도메인 모델이 단순해지고 여러 가지로 편리하다.</p><p>하지만 이 매핑을 실무에서 사용하기에는 한계가 있다. 회원이 상품을 주문하면 연결 테이블에 단순히 주문한 회원 아이디와 상품 아이디만 담고 끝나지 않는다.</p><p>보통은 연결 테이블에 주문 수량 컬럼이나 주문한 날짜 같은 <strong>컬럼이 더 필요</strong>하다.</p><p><img loading=lazy src=/images/JPA/SCR-20240905-oipf.png alt=SCR-20240905-oipf width=680 height=auto></p><p>결국, 연결 테이블을 매핑하는 연결 엔티티를 만들고 이곳에 추가한 컬럼들을 매핑해야 한다.</p><p>그리고 엔티티 간의 관계도 테이블 관계처럼 다대다에서 일대다, 다대일 관계로 풀어야 한다.</p><p>여기서는 <code>회원상품(MemberProduct)</code> 엔티티를 추가했다.</p><p><img loading=lazy src=/images/JPA/SCR-20240905-oium.png alt=SCR-20240905-oium width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-oivs.png alt=SCR-20240905-oivs width=680 height=auto></p><p><code>회원상품(MemberProduct)</code> 엔티티를 보면, <strong>기본 키</strong>를 매핑하는 <code>@Id</code> 와 <strong>외래 키</strong>를 매핑하는 <code>@JoinColumn</code>을 동시에 사용해서 <strong>기본 키 + 외래 키</strong>를 한번에 매핑했다.</p><p>그리고 <code>@Idclass</code>를 사용해서 <strong>복합 기본 키</strong>를 매핑했다.</p><h3 id=복합-기본-키>복합 기본 키<a hidden class=anchor aria-hidden=true href=#복합-기본-키>#</a></h3><p>회원상품 엔티티는 기본 키가 <code>MEMBER_ID</code>와 <code>PRODUCT_ID</code>로 이루어진 <strong>복합 기본 키(=복합 키)</strong></p><p>JPA에서 복합 키를 사용하려면 <strong>별도의 식별자 클래스</strong>를 만들어야 한다.</p><p>그리고 엔티티에 <code>@IdClass</code>를 사용해서 식별자 클래스를 지정하면 된다.</p><p><code>MemberProductId</code> 클래스를 <strong>복합 키</strong>를 위한 식별자 클래스로 사용한다.</p><p><strong>[ 복합 키를 위한 식별자 클래스 특징 ]</strong></p><ul><li>복합 키는 <strong>별도의 식별자 클래스</strong>로 만들어야 한다.</li><li><code>Serializable</code>을 구현해야 한다.</li><li><code>equals</code>와 <code>hashCode</code> 메소드를 구현해야 한다.</li><li><strong>기본 생성자</strong>가 있어야 한다.</li><li>식별자 클래스는 <code>public</code>이어야 한다.</li><li><code>@ldClass</code>를 사용하는 방법 외에 <code>@EmbeddedId</code>를 사용하는 방법도 있다.</li></ul><blockquote><p>회원상품(MemberProduct) 은 회원과 상품의 기본 키를 받아서 자신의 기본 키로 사용한다.</p><p>이렇게 부모 테이블의 기본 키를 받아서 자신의 <strong>기본 키 + 외래 키</strong>로 사용하는 것을 <strong>식별 관계 (Identifying Relationship)</strong> 라 한다.</p></blockquote><p><img loading=lazy src=/images/JPA/SCR-20240905-okye.png alt=SCR-20240905-okye width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-olcu.png alt=SCR-20240905-olcu width=680 height=auto></p><p>지금까지는 기본 키가 단순해서 기본 키를 위한 객체를 사용하는 일이 없었지만 <strong>복합 키</strong>가 되면 이야기가 달라진다.</p><p><strong>복합 키</strong>는 항상 <strong>식별자 클래스</strong>를 만들어야한다. <code>em.find()</code>를 보면 생성한 식별자 클래스로 엔티티를 조회한다.</p><p>복합 키를 사용하는 방법은 <strong>복잡</strong>하다. 복합 키를 사용하면 ORM 매핑에서 처리할 <strong>일이 상당히 많아</strong>진다.</p><h2 id=644-다대다-새로운-기본-키-사용>6.4.4 다대다: 새로운 기본 키 사용<a hidden class=anchor aria-hidden=true href=#644-다대다-새로운-기본-키-사용>#</a></h2><p><img loading=lazy src=/images/JPA/SCR-20240905-olwj.png alt=SCR-20240905-olwj width=680 height=auto></p><p>추천하는 기본 키 생성 전략은 <strong>데이터베이스에서 자동으로 생성해주는 대리 키</strong>를 Long 값으로 사용하는 것이다.</p><p>장점은 간편하고 거의 영구히 쓸 수 있으며, 비즈니스에 의존하지 않는다.</p><p>또한 ORM 매핑 시에 복합 키를 만들지 않아도 되므로 간단히 매핑을 완성할 수 있다.</p><p><img loading=lazy src=/images/JPA/SCR-20240905-ombw.png alt=SCR-20240905-ombw width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-ombi.png alt=SCR-20240905-ombi width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-ombw.png alt=SCR-20240905-ombw width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240905-omks.png alt=SCR-20240905-omks width=680 height=auto></p><p>식별자 클래스를 사용하지 않아서 <strong>코드가 한결 단순해짐</strong></p><p>이처럼 <strong>새로운 기본 키</strong>를 사용해서 다대다 관계를 풀어내는 것도 좋은 방법</p><h2 id=645-다대다-연관관계-정리>6.4.5 다대다 연관관계 정리<a hidden class=anchor aria-hidden=true href=#645-다대다-연관관계-정리>#</a></h2><ul><li><strong>식별 관계</strong>: 받아온 식별자를 <strong>기본 키 + 외래 키</strong>로 사용한다.</li><li><strong>비식별 관계</strong>: 받아온 식별자는 <strong>외래 키로만</strong> 사용하고 <strong>새로운 식별자</strong>를 추가한다.<ul><li>식별자 클래스를 만들지 않아도 편리하게 ORM 매핑 가능</li><li>이런 이유로 식별 관계보다는 <strong>비식별 관계</strong>를 추천</li></ul></li></ul><h1 id=65-활용-kotlin>6.5 활용 (Kotlin)<a hidden class=anchor aria-hidden=true href=#65-활용-kotlin>#</a></h1><h2 id=요구-사항-분석-및-설계>요구 사항 분석 및 설계<a hidden class=anchor aria-hidden=true href=#요구-사항-분석-및-설계>#</a></h2><p><img loading=lazy src=/images/JPA/SCR-20240909-migk.png alt=SCR-20240909-migk width=680 height=auto></p><p><img loading=lazy src=/images/JPA/SCR-20240909-mihg.png alt=SCR-20240909-mihg width=680 height=auto></p><h2 id=code>Code<a hidden class=anchor aria-hidden=true href=#code>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=c1>// build.gradle.kts에 아래 설정이 있다고 가정
</span></span></span><span class=line><span class=cl><span class=c1>// Kotlin으로 JPA을 쉽게 사용하기 위한 설정
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=n>plugins</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>kotlin</span><span class=p>(</span><span class=s2>&#34;plugin.jpa&#34;</span><span class=p>)</span> <span class=n>version</span> <span class=s2>&#34;1.9.24&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>allOpen</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>annotation</span><span class=p>(</span><span class=s2>&#34;jakarta.persistence.Entity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>annotation</span><span class=p>(</span><span class=s2>&#34;jakarta.persistence.Embeddable&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>annotation</span><span class=p>(</span><span class=s2>&#34;jakarta.persistence.MappedSuperclass&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>noArg</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>annotation</span><span class=p>(</span><span class=s2>&#34;jakarta.persistence.Entity&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>package</span> <span class=nn>~~</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>jakarta.persistence.*</span>
</span></span><span class=line><span class=cl><span class=k>import</span> <span class=nn>java.util.Date</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Member</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=n>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>street</span><span class=p>:</span> <span class=n>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>zipcode</span><span class=p>:</span> <span class=n>String</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;MEMBER_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>id</span><span class=p>:</span> <span class=n>Long</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>name</span> <span class=p>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>street</span> <span class=p>=</span> <span class=n>street</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>zipcode</span> <span class=p>=</span> <span class=n>zipcode</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@OneToMany</span><span class=p>(</span><span class=n>mappedBy</span> <span class=p>=</span> <span class=s2>&#34;member&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>orders</span><span class=p>:</span> <span class=n>MutableList</span><span class=p>&lt;</span><span class=n>Order</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>mutableListOf</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>OrderStatus</span> <span class=p>{</span> <span class=n>ORDER</span><span class=p>,</span> <span class=n>CANCEL</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>enum</span> <span class=k>class</span> <span class=nc>DeliveryStatus</span> <span class=p>{</span> <span class=n>READY</span><span class=p>,</span> <span class=n>COMP</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;DELIVERY&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Delivery</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>zipcode</span><span class=p>:</span> <span class=n>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span><span class=p>:</span> <span class=n>DeliveryStatus</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;DELIVERY_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>id</span><span class=p>:</span> <span class=n>Long</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>zipcode</span> <span class=p>=</span> <span class=n>zipcode</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Enumerated</span><span class=p>(</span><span class=nc>EnumType</span><span class=p>.</span><span class=n>STRING</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>status</span><span class=p>:</span> <span class=n>DeliveryStatus</span> <span class=p>=</span> <span class=n>status</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@OneToOne</span><span class=p>(</span><span class=n>mappedBy</span> <span class=p>=</span> <span class=s2>&#34;delivery&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>associateWithOrder</span><span class=p>(</span><span class=n>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>order</span> <span class=p>=</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;ORDERS&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Order</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>member</span><span class=p>:</span> <span class=n>Member</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>orderDate</span><span class=p>:</span> <span class=n>Date</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>status</span><span class=p>:</span> <span class=n>OrderStatus</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;ORDER_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>id</span><span class=p>:</span> <span class=n>Long</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;MEMBER_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>memberId</span><span class=p>:</span> <span class=n>Long</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Temporal</span><span class=p>(</span><span class=nc>TemporalType</span><span class=p>.</span><span class=n>TIMESTAMP</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>orderDate</span><span class=p>:</span> <span class=n>Date</span> <span class=p>=</span> <span class=n>orderDate</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Enumerated</span><span class=p>(</span><span class=nc>EnumType</span><span class=p>.</span><span class=n>STRING</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>status</span><span class=p>:</span> <span class=n>OrderStatus</span> <span class=p>=</span> <span class=n>status</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ManyToOne</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;MEMBER_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>member</span><span class=p>:</span> <span class=n>Member</span><span class=p>?</span> <span class=p>=</span> <span class=n>member</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@OneToMany</span><span class=p>(</span><span class=n>mappedBy</span> <span class=p>=</span> <span class=s2>&#34;order&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>orderItems</span><span class=p>:</span> <span class=n>MutableList</span><span class=p>&lt;</span><span class=n>OrderItem</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>mutableListOf</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@OneToOne</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;DELIVERY_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>delivery</span><span class=p>:</span> <span class=n>Delivery</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>settingMember</span><span class=p>(</span><span class=n>member</span><span class=p>:</span> <span class=n>Member</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>member</span><span class=o>?.</span><span class=n>let</span> <span class=p>{</span> <span class=k>it</span><span class=p>.</span><span class=n>orders</span><span class=p>.</span><span class=n>remove</span><span class=p>(</span><span class=k>this</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>member</span> <span class=p>=</span> <span class=n>member</span>
</span></span><span class=line><span class=cl>        <span class=n>member</span><span class=p>.</span><span class=n>orders</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>addOrderItem</span><span class=p>(</span><span class=n>orderItem</span><span class=p>:</span> <span class=n>OrderItem</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>orderItem</span><span class=p>.</span><span class=n>order</span><span class=o>?.</span><span class=n>let</span> <span class=p>{</span> <span class=k>it</span><span class=p>.</span><span class=n>orderItems</span><span class=p>.</span><span class=n>remove</span><span class=p>(</span><span class=n>orderItem</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>orderItems</span><span class=p>.</span><span class=n>add</span><span class=p>(</span><span class=n>orderItem</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>orderItem</span><span class=p>.</span><span class=n>associateWithOrder</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>settingDelivery</span><span class=p>(</span><span class=n>delivery</span><span class=p>:</span> <span class=n>Delivery</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>delivery</span> <span class=p>=</span> <span class=n>delivery</span>
</span></span><span class=line><span class=cl>        <span class=n>delivery</span><span class=p>.</span><span class=n>associateWithOrder</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>OrderItem</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>orderPrice</span><span class=p>:</span> <span class=n>Int</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>count</span><span class=p>:</span> <span class=n>Int</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;ORDER_ITEM_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>id</span><span class=p>:</span> <span class=n>Long</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;ITEM_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>itemID</span><span class=p>:</span> <span class=n>Long</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>orderPrice</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=n>orderPrice</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>count</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=n>count</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@ManyToOne</span>
</span></span><span class=line><span class=cl>    <span class=nd>@JoinColumn</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;ORDER_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>fun</span> <span class=nf>associateWithOrder</span><span class=p>(</span><span class=n>order</span><span class=p>:</span> <span class=n>Order</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>order</span> <span class=p>=</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@Entity</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Item</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=n>String</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>price</span><span class=p>:</span> <span class=n>Int</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>stockQuantity</span><span class=p>:</span> <span class=n>Int</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Id</span>
</span></span><span class=line><span class=cl>    <span class=nd>@GeneratedValue</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Column</span><span class=p>(</span><span class=n>name</span> <span class=p>=</span> <span class=s2>&#34;ITEM_ID&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>id</span><span class=p>:</span> <span class=n>Long</span><span class=p>?</span> <span class=p>=</span> <span class=k>null</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>name</span><span class=p>:</span> <span class=n>String</span> <span class=p>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>price</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=n>price</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>stockQuantity</span><span class=p>:</span> <span class=n>Int</span> <span class=p>=</span> <span class=n>stockQuantity</span>
</span></span><span class=line><span class=cl>        <span class=k>protected</span> <span class=k>set</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h1><ul><li>자바 ORM 표준 JPA 프로그래밍 (김영한) <a href=https://product.kyobobook.co.kr/detail/S000001766367>https://product.kyobobook.co.kr/detail/S000001766367</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://2taezeat.github.io/tags/jpa/>JPA</a></li><li><a href=https://2taezeat.github.io/tags/backend/>Backend</a></li></ul><nav class=paginav><a class=prev href=https://2taezeat.github.io/posts/jpa/%EC%9E%90%EB%B0%94-orm-%ED%91%9C%EC%A4%80-jpa-ch07.-%EA%B3%A0%EA%B8%89-%EB%A7%A4%ED%95%91/><span class=title>« Prev</span><br><span>[자바 ORM 표준 JPA] ch07. 고급 매핑</span>
</a><a class=next href=https://2taezeat.github.io/posts/jpa/%EC%9E%90%EB%B0%94-orm-%ED%91%9C%EC%A4%80-jpa-ch05.-%EC%97%B0%EA%B4%80%EA%B4%80%EA%B3%84-%EB%A7%A4%ED%95%91-%EA%B8%B0%EC%B4%88/><span class=title>Next »</span><br><span>[자바 ORM 표준 JPA] ch05. 연관관계 매핑 기초</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share [자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑 on x" href="https://x.com/intent/tweet/?text=%5b%ec%9e%90%eb%b0%94%20ORM%20%ed%91%9c%ec%a4%80%20JPA%5d%20ch06.%20%eb%8b%a4%ec%96%91%ed%95%9c%20%ec%97%b0%ea%b4%80%ea%b4%80%ea%b3%84%20%eb%a7%a4%ed%95%91&amp;url=https%3a%2f%2f2taezeat.github.io%2fposts%2fjpa%2f%25EC%259E%2590%25EB%25B0%2594-orm-%25ED%2591%259C%25EC%25A4%2580-jpa-ch06.-%25EB%258B%25A4%25EC%2596%2591%25ED%2595%259C-%25EC%2597%25B0%25EA%25B4%2580%25EA%25B4%2580%25EA%25B3%2584-%25EB%25A7%25A4%25ED%2595%2591%2f&amp;hashtags=JPA%2cBackend"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f2taezeat.github.io%2fposts%2fjpa%2f%25EC%259E%2590%25EB%25B0%2594-orm-%25ED%2591%259C%25EC%25A4%2580-jpa-ch06.-%25EB%258B%25A4%25EC%2596%2591%25ED%2595%259C-%25EC%2597%25B0%25EA%25B4%2580%25EA%25B4%2580%25EA%25B3%2584-%25EB%25A7%25A4%25ED%2595%2591%2f&amp;title=%5b%ec%9e%90%eb%b0%94%20ORM%20%ed%91%9c%ec%a4%80%20JPA%5d%20ch06.%20%eb%8b%a4%ec%96%91%ed%95%9c%20%ec%97%b0%ea%b4%80%ea%b4%80%ea%b3%84%20%eb%a7%a4%ed%95%91&amp;summary=%5b%ec%9e%90%eb%b0%94%20ORM%20%ed%91%9c%ec%a4%80%20JPA%5d%20ch06.%20%eb%8b%a4%ec%96%91%ed%95%9c%20%ec%97%b0%ea%b4%80%ea%b4%80%ea%b3%84%20%eb%a7%a4%ed%95%91&amp;source=https%3a%2f%2f2taezeat.github.io%2fposts%2fjpa%2f%25EC%259E%2590%25EB%25B0%2594-orm-%25ED%2591%259C%25EC%25A4%2580-jpa-ch06.-%25EB%258B%25A4%25EC%2596%2591%25ED%2595%259C-%25EC%2597%25B0%25EA%25B4%2580%25EA%25B4%2580%25EA%25B3%2584-%25EB%25A7%25A4%25ED%2595%2591%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2f2taezeat.github.io%2fposts%2fjpa%2f%25EC%259E%2590%25EB%25B0%2594-orm-%25ED%2591%259C%25EC%25A4%2580-jpa-ch06.-%25EB%258B%25A4%25EC%2596%2591%25ED%2595%259C-%25EC%2597%25B0%25EA%25B4%2580%25EA%25B4%2580%25EA%25B3%2584-%25EB%25A7%25A4%25ED%2595%2591%2f&title=%5b%ec%9e%90%eb%b0%94%20ORM%20%ed%91%9c%ec%a4%80%20JPA%5d%20ch06.%20%eb%8b%a4%ec%96%91%ed%95%9c%20%ec%97%b0%ea%b4%80%ea%b4%80%ea%b3%84%20%eb%a7%a4%ed%95%91"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f2taezeat.github.io%2fposts%2fjpa%2f%25EC%259E%2590%25EB%25B0%2594-orm-%25ED%2591%259C%25EC%25A4%2580-jpa-ch06.-%25EB%258B%25A4%25EC%2596%2591%25ED%2595%259C-%25EC%2597%25B0%25EA%25B4%2580%25EA%25B4%2580%25EA%25B3%2584-%25EB%25A7%25A4%25ED%2595%2591%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑 on whatsapp" href="https://api.whatsapp.com/send?text=%5b%ec%9e%90%eb%b0%94%20ORM%20%ed%91%9c%ec%a4%80%20JPA%5d%20ch06.%20%eb%8b%a4%ec%96%91%ed%95%9c%20%ec%97%b0%ea%b4%80%ea%b4%80%ea%b3%84%20%eb%a7%a4%ed%95%91%20-%20https%3a%2f%2f2taezeat.github.io%2fposts%2fjpa%2f%25EC%259E%2590%25EB%25B0%2594-orm-%25ED%2591%259C%25EC%25A4%2580-jpa-ch06.-%25EB%258B%25A4%25EC%2596%2591%25ED%2595%259C-%25EC%2597%25B0%25EA%25B4%2580%25EA%25B4%2580%25EA%25B3%2584-%25EB%25A7%25A4%25ED%2595%2591%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑 on telegram" href="https://telegram.me/share/url?text=%5b%ec%9e%90%eb%b0%94%20ORM%20%ed%91%9c%ec%a4%80%20JPA%5d%20ch06.%20%eb%8b%a4%ec%96%91%ed%95%9c%20%ec%97%b0%ea%b4%80%ea%b4%80%ea%b3%84%20%eb%a7%a4%ed%95%91&amp;url=https%3a%2f%2f2taezeat.github.io%2fposts%2fjpa%2f%25EC%259E%2590%25EB%25B0%2594-orm-%25ED%2591%259C%25EC%25A4%2580-jpa-ch06.-%25EB%258B%25A4%25EC%2596%2591%25ED%2595%259C-%25EC%2597%25B0%25EA%25B4%2580%25EA%25B4%2580%25EA%25B3%2584-%25EB%25A7%25A4%25ED%2595%2591%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [자바 ORM 표준 JPA] ch06. 다양한 연관관계 매핑 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%5b%ec%9e%90%eb%b0%94%20ORM%20%ed%91%9c%ec%a4%80%20JPA%5d%20ch06.%20%eb%8b%a4%ec%96%91%ed%95%9c%20%ec%97%b0%ea%b4%80%ea%b4%80%ea%b3%84%20%eb%a7%a4%ed%95%91&u=https%3a%2f%2f2taezeat.github.io%2fposts%2fjpa%2f%25EC%259E%2590%25EB%25B0%2594-orm-%25ED%2591%259C%25EC%25A4%2580-jpa-ch06.-%25EB%258B%25A4%25EC%2596%2591%25ED%2595%259C-%25EC%2597%25B0%25EA%25B4%2580%25EA%25B4%2580%25EA%25B3%2584-%25EB%25A7%25A4%25ED%2595%2591%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://utteranc.es/client.js repo=2taezeat/blog_comment issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://2taezeat.github.io/>2taezeat, blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>