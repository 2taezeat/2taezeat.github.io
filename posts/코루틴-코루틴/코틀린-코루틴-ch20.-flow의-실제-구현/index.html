<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[코루틴 코루틴] ch20. Flow의 실제 구현 | 2taezeat, blog</title>
<meta name=keywords content="Kotlin,Coroutine"><meta name=description content="ch20. Flow의 실제 구현"><meta name=author content="2taezeat"><link rel=canonical href=https://2taezeat.github.io/posts/%EC%BD%94%EB%A3%A8%ED%8B%B4-%EC%BD%94%EB%A3%A8%ED%8B%B4/%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%BD%94%EB%A3%A8%ED%8B%B4-ch20.-flow%EC%9D%98-%EC%8B%A4%EC%A0%9C-%EA%B5%AC%ED%98%84/><meta name=google-site-verification content="YaEERzgrvu-ZwPg7gswZdTzRMufkHw3uIH7i8hVal1c"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.d54e889b3efa74e861d01cb8a15d5c39543cc6de6faafd93fc37426183137d6d.css integrity="sha256-1U6Imz76dOhh0By4oV1cOVQ8xt5vqv2T/DdCYYMTfW0=" rel="preload stylesheet" as=style><link rel=icon href=https://2taezeat.github.io/icon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://2taezeat.github.io/icon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://2taezeat.github.io/icon/favicon-32x32.png><link rel=apple-touch-icon href=https://2taezeat.github.io/icon/apple-touch-icon.png><link rel=mask-icon href=https://2taezeat.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://2taezeat.github.io/posts/%EC%BD%94%EB%A3%A8%ED%8B%B4-%EC%BD%94%EB%A3%A8%ED%8B%B4/%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%BD%94%EB%A3%A8%ED%8B%B4-ch20.-flow%EC%9D%98-%EC%8B%A4%EC%A0%9C-%EA%B5%AC%ED%98%84/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="[코루틴 코루틴] ch20. Flow의 실제 구현"><meta property="og:description" content="ch20. Flow의 실제 구현"><meta property="og:type" content="article"><meta property="og:url" content="https://2taezeat.github.io/posts/%EC%BD%94%EB%A3%A8%ED%8B%B4-%EC%BD%94%EB%A3%A8%ED%8B%B4/%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%BD%94%EB%A3%A8%ED%8B%B4-ch20.-flow%EC%9D%98-%EC%8B%A4%EC%A0%9C-%EA%B5%AC%ED%98%84/"><meta property="og:image" content="https://2taezeat.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-02-20T11:30:03+00:00"><meta property="article:modified_time" content="2024-02-20T11:30:03+00:00"><meta property="og:site_name" content="2taezeat, blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://2taezeat.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="[코루틴 코루틴] ch20. Flow의 실제 구현"><meta name=twitter:description content="ch20. Flow의 실제 구현"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://2taezeat.github.io/posts/"},{"@type":"ListItem","position":2,"name":"[코루틴 코루틴] ch20. Flow의 실제 구현","item":"https://2taezeat.github.io/posts/%EC%BD%94%EB%A3%A8%ED%8B%B4-%EC%BD%94%EB%A3%A8%ED%8B%B4/%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%BD%94%EB%A3%A8%ED%8B%B4-ch20.-flow%EC%9D%98-%EC%8B%A4%EC%A0%9C-%EA%B5%AC%ED%98%84/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[코루틴 코루틴] ch20. Flow의 실제 구현","name":"[코루틴 코루틴] ch20. Flow의 실제 구현","description":"ch20. Flow의 실제 구현","keywords":["Kotlin","Coroutine"],"articleBody":"플로우의 실제 구현 기본적으로 플로우는 어떤 연산을 실행할지 정의한 것 중단 가능한 람다식에 몇 가지 요소를 추가하였다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 interface MyFlow { suspend fun myCollect(collector: MyFlowCollector) } fun myFlowBuilder(actionBlock: suspend MyFlowCollector.() -\u003e Unit) = object : MyFlow { override suspend fun myCollect(collector: MyFlowCollector) { collector.actionBlock() } } fun interface MyFlowCollector { // SAM 사용 suspend fun myEmit(value: String) } suspend fun main() { // SAM 사용 val f: MyFlow = myFlowBuilder { this.myEmit(\"A\") // this = myFlowCollector, 생략 가능 myEmit(\"B\") } f.myCollect { println(it) } } /////////////////////////////////////////////////////// interface MyFlowCollector { // SAM 미 사용 suspend fun myEmit(value: String) } suspend fun main() { // SAM 미 사용 val f: MyFlow = myFlowBuilder { this.myEmit(\"A\") // this = myFlowCollector, 생략 가능 myEmit(\"B\") } f.myCollect(object : MyFlowCollector { override suspend fun myEmit(value: String) { println(value) } }) } collect를 호출하면, flow 빌더를 호출 할 때 넣은 람다식이 실행된다.\n빌더의 람다식이 emit을 호출하면, collect가 호출되었을 때 명시된 람다식이 호출된다.\nFlow 처리 방식 플로우의 각 원소를 변환하는 map 함수 map 함수는 새로운 플로우를 만들기 때문에, flow 빌더를 사용한다. 플로우가 시작되면, 래핑하고 있는 플로우를 시작하게 되므로, 빌더 내부에서 collect 메소드를 호출한다. 원소를 받을 때마다, map은 원소를 변환하고 새로운 플로우로 방출한다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 fun \u003cT, R\u003e Flow\u003cT\u003e.map( transformation: suspend (T) -\u003e R ): Flow\u003cR\u003e = flow { collect { emit(transformation(it)) } } suspend fun main() { flowOf(\"A\", \"B\", \"C\").map { delay(1000) it.lowercase() }.collect { println(it) } } // (1 sec) // a // (1 sec) // b // (1 sec) // c 동기로 작동하는 Flow 플로우 또한 중단 함수 처럼 동기로 작동한다. 플로우가 완료될 때까지 collect 호출이 중단(suspend) 된다. 즉, 플로우는 새로운 코루틴을 시작하지 않는다. 중단 함수가 코루틴을 시작할 수 있는 것처럼, 플로우의 각 단계에서도 코루틴을 시작할 수 있지만 중단 함수의 기본 동작은 아니다. 플로우의 각각의 처리 단계는 동기로 실행되기 때문에, onEach 내부에 delay가 있으면 모든 원소가 처리되기 전이 아닌 원소 사이에 지연이 생긴다. 1 2 3 suspend fun main() { flowOf(\"A\", \"B\", \"C\").onEach { delay(1000) }.collect { println(it) } } // (1 sec) // A // (1 sec) // B // (1 sec) // C 플로우와 공유 상태 커스텀한 플로우 처리 함수를 구현할 때, 플로우의 각 단계가 동기로 작동하기 때문에 동기화 없이도 플로우 내부에 변경 가능한 상태를 정의할 수 있다.\n플로우 단계 외부의 변수를 추출해서, 함수에서 사용하는 것이 흔히 저지르는 실수 중 하나이다.\n외부 변수는 같은 플로우가 모으는, 모든 코루틴이 공유하게 된다. 이런 경우 동기화가 필수이며, 플로우 컬렉션이 아니라 플로우에 종속되게 된다. 따라서 두 개의 코루틴이 병렬로 원소를 세게 된다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 fun Flow\u003c*\u003e.counter() = flow\u003cInt\u003e { var counter = 0 collect { counter++ // to make it busy for a while List(100) { Random.nextLong() }.shuffled().sorted() emit(counter) } } suspend fun main(): Unit = coroutineScope { val f1 = List(1000) { \"$it\" }.asFlow() val f2 = List(1000) { \"$it\" }.asFlow().counter() launch { println(f1.counter().last()) } // 1000 launch { println(f1.counter().last()) } // 1000 launch { println(f2.last()) } // 1000 launch { println(f2.last()) } // 1000 } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 fun Flow\u003c*\u003e.counter(): Flow\u003cInt\u003e { var counter = 0 return this.map { counter++ List(100) { Random.nextLong() }.shuffled().sorted() counter } } suspend fun main(): Unit = coroutineScope { val f1 = List(1000) { \"$it\" }.asFlow() val f2 = List(1000) { \"$it\" }.asFlow().counter() launch { println(f1.counter().last()) } // 1000 launch { println(f1.counter().last()) } // 1000 launch { println(f2.last()) } // less than 2000 launch { println(f2.last()) } // less than 2000 // 콘솔 결과 창에서, 4개 print 결과 중 2개는 1000, 나머지는 2개는 2000보다 작다. } 같은 변수를 사용하는 중단 함수들에서 동기화가 필요한 것처럼,\n플로우에서 사용하는 변수가 함수 외부, 클래스의 스코프, 최상위 레벨에서 정의되어 있으면 동기화가 필요하다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 var counter = 0 // 최상위 레벨 변수 fun Flow\u003c*\u003e.counter(): Flow\u003cInt\u003e = this.map { counter++ List(100) { Random.nextLong() }.shuffled().sorted() counter } suspend fun main(): Unit = coroutineScope { val f1 = List(1000) { \"$it\" }.asFlow() val f2 = List(1000) { \"$it\" }.asFlow().counter() launch { println(f1.counter().last()) } // 3496, less than 4000 launch { println(f1.counter().last()) } // 3735 launch { println(f2.last()) } // 3870 launch { println(f2.last()) } // 3933 } Reference https://kotlinlang.org/docs/coroutines-guide.html 코틀린 코루틴 Kotlin Coroutines: Deep Dive (Marcin Moskała, 인사이트) ","wordCount":"765","inLanguage":"en","image":"https://2taezeat.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-02-20T11:30:03Z","dateModified":"2024-02-20T11:30:03Z","author":{"@type":"Person","name":"2taezeat"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://2taezeat.github.io/posts/%EC%BD%94%EB%A3%A8%ED%8B%B4-%EC%BD%94%EB%A3%A8%ED%8B%B4/%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%BD%94%EB%A3%A8%ED%8B%B4-ch20.-flow%EC%9D%98-%EC%8B%A4%EC%A0%9C-%EA%B5%AC%ED%98%84/"},"publisher":{"@type":"Organization","name":"2taezeat, blog","logo":{"@type":"ImageObject","url":"https://2taezeat.github.io/icon/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://2taezeat.github.io/ accesskey=h title="2taezeat blog (Alt + H)"><img src=https://2taezeat.github.io/icon/apple-touch-icon.png alt aria-label=logo height=30>2taezeat blog</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://2taezeat.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://2taezeat.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://2taezeat.github.io/searchs/ title=Search><span>Search</span></a></li><li><a href=https://github.com/2taezeat title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://2taezeat.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://2taezeat.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">[코루틴 코루틴] ch20. Flow의 실제 구현</h1><div class=post-description>ch20. Flow의 실제 구현</div><div class=post-meta><span title='2024-02-20 11:30:03 +0000 +0000'>2024-02-20</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;765 words&nbsp;·&nbsp;2taezeat</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#플로우의-실제-구현>플로우의 실제 구현</a><ul><li><a href=#flow-처리-방식>Flow 처리 방식</a></li><li><a href=#동기로-작동하는-flow>동기로 작동하는 Flow</a></li><li><a href=#플로우와-공유-상태>플로우와 공유 상태</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></div></details></div><div class=post-content><h1 id=플로우의-실제-구현>플로우의 실제 구현<a hidden class=anchor aria-hidden=true href=#플로우의-실제-구현>#</a></h1><ul><li><strong>기본적으로 플로우는 어떤 연산을 실행할지 정의한 것</strong><ul><li>중단 가능한 람다식에 몇 가지 요소를 추가하였다.</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>interface</span> <span class=nc>MyFlow</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>suspend</span> <span class=k>fun</span> <span class=nf>myCollect</span><span class=p>(</span><span class=n>collector</span><span class=p>:</span> <span class=n>MyFlowCollector</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>myFlowBuilder</span><span class=p>(</span><span class=n>actionBlock</span><span class=p>:</span> <span class=k>suspend</span> <span class=nc>MyFlowCollector</span><span class=p>.()</span> <span class=o>-&gt;</span> <span class=n>Unit</span><span class=p>)</span> <span class=p>=</span> <span class=k>object</span> <span class=err>: </span><span class=nc>MyFlow</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>suspend</span> <span class=k>fun</span> <span class=nf>myCollect</span><span class=p>(</span><span class=n>collector</span><span class=p>:</span> <span class=n>MyFlowCollector</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>collector</span><span class=p>.</span><span class=n>actionBlock</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>interface</span> <span class=n>MyFlowCollector</span> <span class=p>{</span> <span class=c1>// SAM 사용 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>suspend</span> <span class=k>fun</span> <span class=nf>myEmit</span><span class=p>(</span><span class=k>value</span><span class=p>:</span> <span class=n>String</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>suspend</span> <span class=k>fun</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// SAM 사용 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>val</span> <span class=py>f</span><span class=p>:</span> <span class=n>MyFlow</span> <span class=p>=</span> <span class=n>myFlowBuilder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>myEmit</span><span class=p>(</span><span class=s2>&#34;A&#34;</span><span class=p>)</span> <span class=c1>// this = myFlowCollector, 생략 가능
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>myEmit</span><span class=p>(</span><span class=s2>&#34;B&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=p>.</span><span class=n>myCollect</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=k>it</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>///////////////////////////////////////////////////////
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>interface</span> <span class=nc>MyFlowCollector</span> <span class=p>{</span> <span class=c1>// SAM 미 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>suspend</span> <span class=k>fun</span> <span class=nf>myEmit</span><span class=p>(</span><span class=k>value</span><span class=p>:</span> <span class=n>String</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>suspend</span> <span class=k>fun</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span> <span class=c1>// SAM 미 사용
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>val</span> <span class=py>f</span><span class=p>:</span> <span class=n>MyFlow</span> <span class=p>=</span> <span class=n>myFlowBuilder</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>myEmit</span><span class=p>(</span><span class=s2>&#34;A&#34;</span><span class=p>)</span> <span class=c1>// this = myFlowCollector, 생략 가능
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>myEmit</span><span class=p>(</span><span class=s2>&#34;B&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>f</span><span class=p>.</span><span class=n>myCollect</span><span class=p>(</span><span class=k>object</span> <span class=err>: </span><span class=nc>MyFlowCollector</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>override</span> <span class=k>suspend</span> <span class=k>fun</span> <span class=nf>myEmit</span><span class=p>(</span><span class=k>value</span><span class=p>:</span> <span class=n>String</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>println</span><span class=p>(</span><span class=k>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>})</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p><strong>collect</strong>를 호출하면, <strong>flow 빌더</strong>를 호출 할 때 넣은 <strong>람다식</strong>이 실행된다.</p></li><li><p>빌더의 람다식이 <strong>emit을 호출</strong>하면, <strong>collect</strong>가 호출되었을 때 <strong>명시된 람다식</strong>이 호출된다.</p></li></ul><h2 id=flow-처리-방식>Flow 처리 방식<a hidden class=anchor aria-hidden=true href=#flow-처리-방식>#</a></h2><ul><li>플로우의 각 원소를 변환하는 map 함수<ul><li><code>map 함수</code>는 <strong>새로운 플로우를 만들기</strong> 때문에, <strong>flow 빌더</strong>를 사용한다.</li><li>플로우가 시작되면, 래핑하고 있는 플로우를 시작하게 되므로, 빌더 내부에서 <strong>collect</strong> 메소드를 호출한다.</li><li>원소를 <strong>받을 때마다</strong>, map은 원소를 변환하고 <strong>새로운 플로우로 방출</strong>한다.</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>fun</span> <span class=p>&lt;</span><span class=nc>T</span><span class=p>,</span> <span class=nc>R</span><span class=p>&gt;</span> <span class=nf>Flow</span><span class=p>&lt;</span><span class=n>T</span><span class=p>&gt;.</span><span class=n>map</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>transformation</span><span class=p>:</span> <span class=k>suspend</span> <span class=p>(</span><span class=n>T</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>R</span>
</span></span><span class=line><span class=cl><span class=p>):</span> <span class=n>Flow</span><span class=p>&lt;</span><span class=n>R</span><span class=p>&gt;</span> <span class=p>=</span> <span class=n>flow</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>collect</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>emit</span><span class=p>(</span><span class=n>transformation</span><span class=p>(</span><span class=k>it</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>suspend</span> <span class=k>fun</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>flowOf</span><span class=p>(</span><span class=s2>&#34;A&#34;</span><span class=p>,</span> <span class=s2>&#34;B&#34;</span><span class=p>,</span> <span class=s2>&#34;C&#34;</span><span class=p>).</span><span class=n>map</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>delay</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>it</span><span class=p>.</span><span class=n>lowercase</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}.</span><span class=n>collect</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=k>it</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=c1>// (1 sec) // a // (1 sec) // b // (1 sec) // c
</span></span></span></code></pre></td></tr></table></div></div><h2 id=동기로-작동하는-flow>동기로 작동하는 Flow<a hidden class=anchor aria-hidden=true href=#동기로-작동하는-flow>#</a></h2><ul><li>플로우 또한 <code>중단 함수</code> 처럼 <strong>동기</strong>로 작동한다.<ul><li>플로우가 완료될 때까지 <strong>collect</strong> 호출이 <strong>중단(suspend)</strong> 된다.</li><li>즉, 플로우는 새로운 코루틴을 시작하지 않는다.</li><li><code>중단 함수</code>가 코루틴을 시작할 수 있는 것처럼, 플로우의 각 단계에서도 코루틴을 시작할 수 있지만 중단 함수의 기본 동작은 아니다.</li></ul></li><li>플로우의 각각의 처리 단계는 <strong>동기</strong>로 실행되기 때문에, onEach 내부에 <strong>delay</strong>가 있으면 모든 원소가 처리되기 전이 아닌 <strong>원소 사이에 지연</strong>이 생긴다.</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>suspend</span> <span class=k>fun</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>flowOf</span><span class=p>(</span><span class=s2>&#34;A&#34;</span><span class=p>,</span> <span class=s2>&#34;B&#34;</span><span class=p>,</span> <span class=s2>&#34;C&#34;</span><span class=p>).</span><span class=n>onEach</span> <span class=p>{</span> <span class=n>delay</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span> <span class=p>}.</span><span class=n>collect</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=k>it</span><span class=p>)</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=c1>// (1 sec) // A // (1 sec) // B // (1 sec) // C
</span></span></span></code></pre></td></tr></table></div></div><h2 id=플로우와-공유-상태>플로우와 공유 상태<a hidden class=anchor aria-hidden=true href=#플로우와-공유-상태>#</a></h2><ul><li><p>커스텀한 <em>플로우 처리 함수를 구현</em>할 때, 플로우의 <strong>각 단계</strong>가 <strong>동기</strong>로 작동하기 때문에 <strong>동기화</strong> 없이도 플로우 내부에 변경 가능한 상태를 정의할 수 있다.</p></li><li><p>플로우 단계 외부의 변수를 추출해서, 함수에서 사용하는 것이 흔히 저지르는 실수 중 하나이다.</p><ul><li>외부 변수는 같은 플로우가 모으는, 모든 코루틴이 공유하게 된다.</li><li>이런 경우 <strong>동기화</strong>가 필수이며, <strong>플로우 컬렉션이</strong> 아니라 <strong>플로우</strong>에 종속되게 된다.</li><li>따라서 두 개의 코루틴이 병렬로 원소를 세게 된다.</li></ul></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>fun</span> <span class=nf>Flow</span><span class=p>&lt;*&gt;.</span><span class=n>counter</span><span class=p>()</span> <span class=p>=</span> <span class=n>flow</span><span class=p>&lt;</span><span class=n>Int</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>counter</span> <span class=p>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>    <span class=n>collect</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>counter</span><span class=o>++</span> <span class=c1>// to make it busy for a while
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>List</span><span class=p>(</span><span class=m>100</span><span class=p>)</span> <span class=p>{</span> <span class=nc>Random</span><span class=p>.</span><span class=n>nextLong</span><span class=p>()</span> <span class=p>}.</span><span class=n>shuffled</span><span class=p>().</span><span class=n>sorted</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>emit</span><span class=p>(</span><span class=n>counter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>suspend</span> <span class=k>fun</span> <span class=nf>main</span><span class=p>():</span> <span class=n>Unit</span> <span class=p>=</span> <span class=n>coroutineScope</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>f1</span> <span class=p>=</span> <span class=n>List</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span> <span class=p>{</span> <span class=s2>&#34;</span><span class=si>$it</span><span class=s2>&#34;</span> <span class=p>}.</span><span class=n>asFlow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>f2</span> <span class=p>=</span> <span class=n>List</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span> <span class=p>{</span> <span class=s2>&#34;</span><span class=si>$it</span><span class=s2>&#34;</span> <span class=p>}.</span><span class=n>asFlow</span><span class=p>().</span><span class=n>counter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f1</span><span class=p>.</span><span class=n>counter</span><span class=p>().</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 1000
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f1</span><span class=p>.</span><span class=n>counter</span><span class=p>().</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 1000
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f2</span><span class=p>.</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 1000
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f2</span><span class=p>.</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 1000
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>fun</span> <span class=nf>Flow</span><span class=p>&lt;*&gt;.</span><span class=n>counter</span><span class=p>():</span> <span class=n>Flow</span><span class=p>&lt;</span><span class=n>Int</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>var</span> <span class=py>counter</span> <span class=p>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>this</span><span class=p>.</span><span class=n>map</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>counter</span><span class=o>++</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=p>(</span><span class=m>100</span><span class=p>)</span> <span class=p>{</span> <span class=nc>Random</span><span class=p>.</span><span class=n>nextLong</span><span class=p>()</span> <span class=p>}.</span><span class=n>shuffled</span><span class=p>().</span><span class=n>sorted</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>counter</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>suspend</span> <span class=k>fun</span> <span class=nf>main</span><span class=p>():</span> <span class=n>Unit</span> <span class=p>=</span> <span class=n>coroutineScope</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>f1</span> <span class=p>=</span> <span class=n>List</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span> <span class=p>{</span> <span class=s2>&#34;</span><span class=si>$it</span><span class=s2>&#34;</span> <span class=p>}.</span><span class=n>asFlow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>f2</span> <span class=p>=</span> <span class=n>List</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span> <span class=p>{</span> <span class=s2>&#34;</span><span class=si>$it</span><span class=s2>&#34;</span> <span class=p>}.</span><span class=n>asFlow</span><span class=p>().</span><span class=n>counter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f1</span><span class=p>.</span><span class=n>counter</span><span class=p>().</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 1000
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f1</span><span class=p>.</span><span class=n>counter</span><span class=p>().</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 1000
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f2</span><span class=p>.</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// less than 2000
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f2</span><span class=p>.</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// less than 2000
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 콘솔 결과 창에서, 4개 print 결과 중 2개는 1000, 나머지는 2개는 2000보다 작다.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>같은 변수를 사용하는 중단 함수들에서 동기화가 필요한 것처럼,</p><p>플로우에서 사용하는 변수가 <strong>함수 외부, 클래스의 스코프, 최상위 레벨</strong>에서 정의되어 있으면 <strong>동기화</strong>가 필요하다.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>var</span> <span class=py>counter</span> <span class=p>=</span> <span class=m>0</span> <span class=c1>// 최상위 레벨 변수
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=k>fun</span> <span class=nf>Flow</span><span class=p>&lt;*&gt;.</span><span class=n>counter</span><span class=p>():</span> <span class=n>Flow</span><span class=p>&lt;</span><span class=n>Int</span><span class=p>&gt;</span> <span class=p>=</span> <span class=k>this</span><span class=p>.</span><span class=n>map</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>counter</span><span class=o>++</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span><span class=p>(</span><span class=m>100</span><span class=p>)</span> <span class=p>{</span> <span class=nc>Random</span><span class=p>.</span><span class=n>nextLong</span><span class=p>()</span> <span class=p>}.</span><span class=n>shuffled</span><span class=p>().</span><span class=n>sorted</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>counter</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>suspend</span> <span class=k>fun</span> <span class=nf>main</span><span class=p>():</span> <span class=n>Unit</span> <span class=p>=</span> <span class=n>coroutineScope</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>f1</span> <span class=p>=</span> <span class=n>List</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span> <span class=p>{</span> <span class=s2>&#34;</span><span class=si>$it</span><span class=s2>&#34;</span> <span class=p>}.</span><span class=n>asFlow</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>val</span> <span class=py>f2</span> <span class=p>=</span> <span class=n>List</span><span class=p>(</span><span class=m>1000</span><span class=p>)</span> <span class=p>{</span> <span class=s2>&#34;</span><span class=si>$it</span><span class=s2>&#34;</span> <span class=p>}.</span><span class=n>asFlow</span><span class=p>().</span><span class=n>counter</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f1</span><span class=p>.</span><span class=n>counter</span><span class=p>().</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 3496, less than 4000
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f1</span><span class=p>.</span><span class=n>counter</span><span class=p>().</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 3735
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f2</span><span class=p>.</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 3870
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>launch</span> <span class=p>{</span> <span class=n>println</span><span class=p>(</span><span class=n>f2</span><span class=p>.</span><span class=n>last</span><span class=p>())</span> <span class=p>}</span> <span class=c1>// 3933
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h1><ul><li><a href=https://kotlinlang.org/docs/coroutines-guide.html>https://kotlinlang.org/docs/coroutines-guide.html</a></li><li>코틀린 코루틴 Kotlin Coroutines: Deep Dive (Marcin Moskała, 인사이트)</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://2taezeat.github.io/tags/kotlin/>Kotlin</a></li><li><a href=https://2taezeat.github.io/tags/coroutine/>Coroutine</a></li></ul><nav class=paginav><a class=prev href=https://2taezeat.github.io/posts/%EC%BD%94%EB%A3%A8%ED%8B%B4-%EC%BD%94%EB%A3%A8%ED%8B%B4/%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%BD%94%EB%A3%A8%ED%8B%B4-ch21.-flow-%EB%A7%8C%EB%93%A4%EA%B8%B0/><span class=title>« Prev</span><br><span>[코루틴 코루틴] ch21. Flow 만들기</span>
</a><a class=next href=https://2taezeat.github.io/posts/%EC%BD%94%EB%A3%A8%ED%8B%B4-%EC%BD%94%EB%A3%A8%ED%8B%B4/%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%BD%94%EB%A3%A8%ED%8B%B4-ch19.-flow%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80/><span class=title>Next »</span><br><span>[코루틴 코루틴] ch19. Flow란 무엇인가?</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share [코루틴 코루틴] ch20. Flow의 실제 구현 on x" href="https://x.com/intent/tweet/?text=%5b%ec%bd%94%eb%a3%a8%ed%8b%b4%20%ec%bd%94%eb%a3%a8%ed%8b%b4%5d%20ch20.%20Flow%ec%9d%98%20%ec%8b%a4%ec%a0%9c%20%ea%b5%ac%ed%98%84&amp;url=https%3a%2f%2f2taezeat.github.io%2fposts%2f%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4%2f%25EC%25BD%2594%25ED%258B%2580%25EB%25A6%25B0-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-ch20.-flow%25EC%259D%2598-%25EC%258B%25A4%25EC%25A0%259C-%25EA%25B5%25AC%25ED%2598%2584%2f&amp;hashtags=Kotlin%2cCoroutine"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [코루틴 코루틴] ch20. Flow의 실제 구현 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2f2taezeat.github.io%2fposts%2f%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4%2f%25EC%25BD%2594%25ED%258B%2580%25EB%25A6%25B0-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-ch20.-flow%25EC%259D%2598-%25EC%258B%25A4%25EC%25A0%259C-%25EA%25B5%25AC%25ED%2598%2584%2f&amp;title=%5b%ec%bd%94%eb%a3%a8%ed%8b%b4%20%ec%bd%94%eb%a3%a8%ed%8b%b4%5d%20ch20.%20Flow%ec%9d%98%20%ec%8b%a4%ec%a0%9c%20%ea%b5%ac%ed%98%84&amp;summary=%5b%ec%bd%94%eb%a3%a8%ed%8b%b4%20%ec%bd%94%eb%a3%a8%ed%8b%b4%5d%20ch20.%20Flow%ec%9d%98%20%ec%8b%a4%ec%a0%9c%20%ea%b5%ac%ed%98%84&amp;source=https%3a%2f%2f2taezeat.github.io%2fposts%2f%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4%2f%25EC%25BD%2594%25ED%258B%2580%25EB%25A6%25B0-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-ch20.-flow%25EC%259D%2598-%25EC%258B%25A4%25EC%25A0%259C-%25EA%25B5%25AC%25ED%2598%2584%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [코루틴 코루틴] ch20. Flow의 실제 구현 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2f2taezeat.github.io%2fposts%2f%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4%2f%25EC%25BD%2594%25ED%258B%2580%25EB%25A6%25B0-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-ch20.-flow%25EC%259D%2598-%25EC%258B%25A4%25EC%25A0%259C-%25EA%25B5%25AC%25ED%2598%2584%2f&title=%5b%ec%bd%94%eb%a3%a8%ed%8b%b4%20%ec%bd%94%eb%a3%a8%ed%8b%b4%5d%20ch20.%20Flow%ec%9d%98%20%ec%8b%a4%ec%a0%9c%20%ea%b5%ac%ed%98%84"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [코루틴 코루틴] ch20. Flow의 실제 구현 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2f2taezeat.github.io%2fposts%2f%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4%2f%25EC%25BD%2594%25ED%258B%2580%25EB%25A6%25B0-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-ch20.-flow%25EC%259D%2598-%25EC%258B%25A4%25EC%25A0%259C-%25EA%25B5%25AC%25ED%2598%2584%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [코루틴 코루틴] ch20. Flow의 실제 구현 on whatsapp" href="https://api.whatsapp.com/send?text=%5b%ec%bd%94%eb%a3%a8%ed%8b%b4%20%ec%bd%94%eb%a3%a8%ed%8b%b4%5d%20ch20.%20Flow%ec%9d%98%20%ec%8b%a4%ec%a0%9c%20%ea%b5%ac%ed%98%84%20-%20https%3a%2f%2f2taezeat.github.io%2fposts%2f%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4%2f%25EC%25BD%2594%25ED%258B%2580%25EB%25A6%25B0-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-ch20.-flow%25EC%259D%2598-%25EC%258B%25A4%25EC%25A0%259C-%25EA%25B5%25AC%25ED%2598%2584%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [코루틴 코루틴] ch20. Flow의 실제 구현 on telegram" href="https://telegram.me/share/url?text=%5b%ec%bd%94%eb%a3%a8%ed%8b%b4%20%ec%bd%94%eb%a3%a8%ed%8b%b4%5d%20ch20.%20Flow%ec%9d%98%20%ec%8b%a4%ec%a0%9c%20%ea%b5%ac%ed%98%84&amp;url=https%3a%2f%2f2taezeat.github.io%2fposts%2f%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4%2f%25EC%25BD%2594%25ED%258B%2580%25EB%25A6%25B0-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-ch20.-flow%25EC%259D%2598-%25EC%258B%25A4%25EC%25A0%259C-%25EA%25B5%25AC%25ED%2598%2584%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share [코루틴 코루틴] ch20. Flow의 실제 구현 on ycombinator" href="https://news.ycombinator.com/submitlink?t=%5b%ec%bd%94%eb%a3%a8%ed%8b%b4%20%ec%bd%94%eb%a3%a8%ed%8b%b4%5d%20ch20.%20Flow%ec%9d%98%20%ec%8b%a4%ec%a0%9c%20%ea%b5%ac%ed%98%84&u=https%3a%2f%2f2taezeat.github.io%2fposts%2f%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4%2f%25EC%25BD%2594%25ED%258B%2580%25EB%25A6%25B0-%25EC%25BD%2594%25EB%25A3%25A8%25ED%258B%25B4-ch20.-flow%25EC%259D%2598-%25EC%258B%25A4%25EC%25A0%259C-%25EA%25B5%25AC%25ED%2598%2584%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://utteranc.es/client.js repo=2taezeat/blog_comment issue-term=pathname label=comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://2taezeat.github.io/>2taezeat, blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>